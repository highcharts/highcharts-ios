!/**
 * Highcharts JS v11.4.3 (2024-05-22)
 *
 * Highcharts
 *
 * (c) 2010-2024 Highsoft AS
 *
 * License: www.highcharts.com/license
 */function(t){"object"==typeof module&&module.exports?(t.default=t,module.exports=t):"function"==typeof define&&define.amd?define("highcharts/modules/data-tools",["highcharts"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";var e=t?t._modules:{};function r(t,e,r,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,r),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}r(e,"Data/Modifiers/DataModifier.js",[e["Core/Utilities.js"]],function(t){var e,r=t.addEvent,o=t.fireEvent,n=t.merge,i=function(){function t(){}return t.prototype.benchmark=function(t,e){var r=[],o=this,i=function(){o.modifyTable(t),o.emit({type:"afterBenchmarkIteration"})},s=n({iterations:1},e).iterations;o.on("afterBenchmarkIteration",function(){if(r.length===s){o.emit({type:"afterBenchmark",results:r});return}i()});var a={startTime:0,endTime:0};return o.on("modify",function(){a.startTime=window.performance.now()}),o.on("afterModify",function(){a.endTime=window.performance.now(),r.push(a.endTime-a.startTime)}),i(),r},t.prototype.emit=function(t){o(this,t.type,t)},t.prototype.modify=function(t,e){var r=this;return new Promise(function(o,n){t.modified===t&&(t.modified=t.clone(!1,e));try{o(r.modifyTable(t,e))}catch(o){r.emit({type:"error",detail:e,table:t}),n(o)}})},t.prototype.modifyCell=function(t,e,r,o,n){return this.modifyTable(t)},t.prototype.modifyColumns=function(t,e,r,o){return this.modifyTable(t)},t.prototype.modifyRows=function(t,e,r,o){return this.modifyTable(t)},t.prototype.on=function(t,e){return r(this,t,e)},t}();return(e=i||(i={})).types={},e.registerType=function(t,r){return!!t&&!e.types[t]&&!!(e.types[t]=r)},i}),r(e,"Data/DataTable.js",[e["Core/Utilities.js"]],function(t){var e=t.addEvent,r=t.fireEvent,o=t.uniqueKey;return function(){function t(t){void 0===t&&(t={}),this.aliases=t.aliases?JSON.parse(JSON.stringify(t.aliases)):{},this.autoId=!t.id,this.columns={},this.id=t.id||o(),this.modified=this,this.rowCount=0,this.versionTag=o();for(var e=t.columns||{},r=Object.keys(e),n=this.columns,i=0,s=0,a=r.length,u=void 0,l=void 0;s<a;++s)u=e[l=r[s]].slice(),n[l]=u,i=Math.max(i,u.length);for(var s=0,a=r.length;s<a;++s)n[r[s]].length=i;this.rowCount=i;for(var c=t.aliases||{},f=Object.keys(c),p=this.aliases,s=0,a=f.length,h=void 0;s<a;++s)p[h=f[s]]=c[h]}return t.isNull=function(e){if(e===t.NULL)return!0;if(e instanceof Array){if(!e.length)return!1;for(var r=0,o=e.length;r<o;++r)if(null!==e[r])return!1}else{var n=Object.keys(e);if(!n.length)return!1;for(var r=0,o=n.length;r<o;++r)if(null!==e[n[r]])return!1}return!0},t.prototype.clone=function(e,r){var o={};this.emit({type:"cloneTable",detail:r}),e||(o.aliases=this.aliases,o.columns=this.columns),this.autoId||(o.id=this.id);var n=new t(o);return e||(n.versionTag=this.versionTag),this.emit({type:"afterCloneTable",detail:r,tableClone:n}),n},t.prototype.deleteColumnAlias=function(t){var e,r=this.aliases[t],o=this.modifier;return r&&(delete this.aliases[t],o&&o.modifyColumns(this,((e={})[r]=Array(this.rowCount),e),0)),r},t.prototype.deleteColumns=function(t,e){var r=this.columns,o={},n={},i=this.modifier,s=this.rowCount;if((t=t||Object.keys(r)).length){this.emit({type:"deleteColumns",columnNames:t,detail:e});for(var a=0,u=t.length,l=void 0,c=void 0;a<u;++a)(l=r[c=t[a]])&&(o[c]=l,n[c]=Array(s)),delete r[c];return Object.keys(r).length||(this.rowCount=0),i&&i.modifyColumns(this,n,0,e),this.emit({type:"afterDeleteColumns",columns:o,columnNames:t,detail:e}),o}},t.prototype.deleteRows=function(t,e,r){void 0===e&&(e=1);var o=[],n=[],i=this.modifier;if(this.emit({type:"deleteRows",detail:r,rowCount:e,rowIndex:t||0}),void 0===t&&(t=0,e=this.rowCount),e>0&&t<this.rowCount)for(var s=this.columns,a=Object.keys(s),u=0,l=a.length,c=void 0,f=void 0;u<l;++u){f=(c=s[a[u]]).splice(t,e),u||(this.rowCount=c.length);for(var p=0,h=f.length;p<h;++p)o[p]=o[p]||[],o[p][u]=f[p];n.push(Array(l))}return i&&i.modifyRows(this,n,t||0,r),this.emit({type:"afterDeleteRows",detail:r,rowCount:e,rowIndex:t||0,rows:o}),o},t.prototype.emit=function(t){switch(t.type){case"afterDeleteColumns":case"afterDeleteRows":case"afterSetCell":case"afterSetColumns":case"afterSetRows":this.versionTag=o()}r(this,t.type,t)},t.prototype.getCell=function(t,e){t=this.aliases[t]||t;var r=this.columns[t];if(r)return r[e]},t.prototype.getCellAsBoolean=function(t,e){t=this.aliases[t]||t;var r=this.columns[t];return!!(r&&r[e])},t.prototype.getCellAsNumber=function(t,e,r){t=this.aliases[t]||t;var o=this.columns[t],n=o&&o[e];switch(typeof n){case"boolean":return n?1:0;case"number":return isNaN(n)&&!r?null:n}return isNaN(n=parseFloat("".concat(n)))&&!r?null:n},t.prototype.getCellAsString=function(t,e){t=this.aliases[t]||t;var r=this.columns[t];return"".concat(r&&r[e])},t.prototype.getColumn=function(t,e){return this.getColumns([t],e)[t]},t.prototype.getColumnAsNumbers=function(t,e){var r=this.columns[t=this.aliases[t]||t],o=[];if(r){var n=r.length;if(e)for(var i=0;i<n;++i)o.push(this.getCellAsNumber(t,i,!0));else{for(var i=0,s=void 0;i<n;++i){if("number"==typeof(s=r[i]))return r.slice();if(null!=s)break}for(var i=0;i<n;++i)o.push(this.getCellAsNumber(t,i))}}return o},t.prototype.getColumnNames=function(){return Object.keys(this.columns)},t.prototype.getColumns=function(t,e){var r=this.aliases,o=this.columns,n={};t=t||Object.keys(o);for(var i=0,s=t.length,a=void 0,u=void 0;i<s;++i)(a=o[r[u=t[i]]||u])&&(n[u]=e?a:a.slice());return n},t.prototype.getModifier=function(){return this.modifier},t.prototype.getRow=function(t,e){return this.getRows(t,1,e)[0]},t.prototype.getRowCount=function(){return this.rowCount},t.prototype.getRowIndexBy=function(t,e,r){t=this.aliases[t]||t;var o=this.columns[t];if(o){var n=o.indexOf(e,r);if(-1!==n)return n}},t.prototype.getRowObject=function(t,e){return this.getRowObjects(t,1,e)[0]},t.prototype.getRowObjects=function(t,e,r){void 0===t&&(t=0),void 0===e&&(e=this.rowCount-t);var o=this.aliases,n=this.columns,i=Array(e);r=r||Object.keys(n);for(var s=t,a=0,u=Math.min(this.rowCount,t+e),l=void 0,c=void 0;s<u;++s,++a){c=i[a]={};for(var f=0,p=r;f<p.length;f++){var h=p[f];l=n[o[h]||h],c[h]=l?l[s]:void 0}}return i},t.prototype.getRows=function(t,e,r){void 0===t&&(t=0),void 0===e&&(e=this.rowCount-t);var o=this.aliases,n=this.columns,i=Array(e);r=r||Object.keys(n);for(var s=t,a=0,u=Math.min(this.rowCount,t+e),l=void 0,c=void 0;s<u;++s,++a){c=i[a]=[];for(var f=0,p=r;f<p.length;f++){var h=p[f];l=n[o[h]||h],c.push(l?l[s]:void 0)}}return i},t.prototype.getVersionTag=function(){return this.versionTag},t.prototype.hasColumns=function(t){for(var e=this.aliases,r=this.columns,o=0,n=t.length,i=void 0;o<n;++o)if(!r[i=t[o]]&&!e[i])return!1;return!0},t.prototype.hasRowWith=function(t,e){t=this.aliases[t]||t;var r=this.columns[t];return!!r&&-1!==r.indexOf(e)},t.prototype.on=function(t,r){return e(this,t,r)},t.prototype.renameColumn=function(t,e){var r=this.columns;if(r[t]){if(t!==e){var o=this.aliases;o[e]&&delete o[e],r[e]=r[t],delete r[t]}return!0}return!1},t.prototype.setCell=function(t,e,r,o){var n=this.columns,i=this.modifier,s=n[t=this.aliases[t]||t];s&&s[e]===r||(this.emit({type:"setCell",cellValue:r,columnName:t,detail:o,rowIndex:e}),s||(s=n[t]=Array(this.rowCount)),e>=this.rowCount&&(this.rowCount=e+1),s[e]=r,i&&i.modifyCell(this,t,e,r),this.emit({type:"afterSetCell",cellValue:r,columnName:t,detail:o,rowIndex:e}))},t.prototype.setColumn=function(t,e,r,o){var n;void 0===e&&(e=[]),void 0===r&&(r=0),this.setColumns(((n={})[t]=e,n),r,o)},t.prototype.setColumns=function(t,e,r){var o=this.columns,n=this.modifier,i=void 0===e,s=Object.keys(t);this.emit({type:"setColumns",columns:t,columnNames:s,detail:r,rowIndex:e});for(var a=0,u=s.length,l=void 0,c=void 0;a<u;++a)if(l=t[c=s[a]],c=this.aliases[c]||c,i)o[c]=l.slice(),this.rowCount=l.length;else{for(var f=o[c]?o[c]:o[c]=Array(this.rowCount),p=e||0,h=l.length;p<h;++p)f[p]=l[p];this.rowCount=Math.max(this.rowCount,f.length)}for(var m=Object.keys(o),a=0,u=m.length;a<u;++a)o[m[a]].length=this.rowCount;n&&n.modifyColumns(this,t,e||0),this.emit({type:"afterSetColumns",columns:t,columnNames:s,detail:r,rowIndex:e})},t.prototype.setModifier=function(t,e){var r=this;return r.emit({type:"setModifier",detail:e,modifier:t,modified:r.modified}),r.modified=r,r.modifier=t,(t?t.modify(r):Promise.resolve(r)).then(function(r){return r.emit({type:"afterSetModifier",detail:e,modifier:t,modified:r.modified}),r}).catch(function(e){throw r.emit({type:"setModifierError",error:e,modifier:t,modified:r.modified}),e})},t.prototype.setRow=function(t,e,r){this.setRows([t],e,r)},t.prototype.setRows=function(e,r,o){void 0===r&&(r=this.rowCount);var n=this.aliases,i=this.columns,s=Object.keys(i),a=this.modifier,u=e.length;this.emit({type:"setRows",detail:o,rowCount:u,rowIndex:r,rows:e});for(var l=0,c=r,f=void 0;l<u;++l,++c)if((f=e[l])===t.NULL)for(var p=0,h=s.length;p<h;++p)i[s[p]][c]=null;else if(f instanceof Array)for(var p=0,h=s.length;p<h;++p)i[s[p]][c]=f[p];else for(var m=Object.keys(f),p=0,h=m.length,d=void 0;p<h;++p)i[d=n[d=m[p]]||d]||(i[d]=Array(c+1)),i[d][c]=f[d];var g=r+u;if(g>this.rowCount){this.rowCount=g;for(var l=0,y=s.length;l<y;++l)i[s[l]].length=g}a&&a.modifyRows(this,e,r),this.emit({type:"afterSetRows",detail:o,rowCount:u,rowIndex:r,rows:e})},t.NULL={},t.version="1.0.0",t}()}),r(e,"Data/Connectors/DataConnector.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(t,e,r){var o,n=r.addEvent,i=r.fireEvent,s=r.merge,a=r.pick,u=function(){function r(t){void 0===t&&(t={}),this.table=new e(t.dataTable),this.metadata=t.metadata||{columns:{}}}return Object.defineProperty(r.prototype,"polling",{get:function(){return!!this.polling},enumerable:!1,configurable:!0}),r.prototype.describeColumn=function(t,e){var r=this.metadata.columns;r[t]=s(r[t]||{},e)},r.prototype.describeColumns=function(t){for(var e,r=Object.keys(t);"string"==typeof(e=r.pop());)this.describeColumn(e,t[e])},r.prototype.emit=function(t){i(this,t.type,t)},r.prototype.getColumnOrder=function(t){var e=this.metadata.columns,r=Object.keys(e||{});if(r.length)return r.sort(function(t,r){return a(e[t].index,0)-a(e[r].index,0)})},r.prototype.getSortedColumns=function(t){return this.table.getColumns(this.getColumnOrder(t))},r.prototype.load=function(){return i(this,"afterLoad",{table:this.table}),Promise.resolve(this)},r.prototype.on=function(t,e){return n(this,t,e)},r.prototype.save=function(){return i(this,"saveError",{table:this.table}),Promise.reject(Error("Not implemented"))},r.prototype.setColumnOrder=function(t){for(var e=0,r=t.length;e<r;++e)this.describeColumn(t[e],{index:e})},r.prototype.setModifierOptions=function(e){var r=this,o=e&&t.types[e.type];return this.table.setModifier(o?new o(e):void 0).then(function(){return r})},r.prototype.startPolling=function(t){void 0===t&&(t=1e3);var e=this;window.clearTimeout(e._polling),e._polling=window.setTimeout(function(){return e.load().catch(function(t){return e.emit({type:"loadError",error:t,table:e.table})}).then(function(){e._polling&&e.startPolling(t)})},t)},r.prototype.stopPolling=function(){window.clearTimeout(this._polling),delete this._polling},r.prototype.whatIs=function(t){return this.metadata.columns[t]},r}();return(o=u||(u={})).types={},o.registerType=function(t,e){return!!t&&!o.types[t]&&!!(o.types[t]=e)},u}),r(e,"Data/Converters/DataConverter.js",[e["Data/DataTable.js"],e["Core/Utilities.js"]],function(t,e){var r=e.addEvent,o=e.fireEvent,n=e.isNumber,i=e.merge,s=function(){function t(e){this.dateFormats={"YYYY/mm/dd":{regex:/^([0-9]{4})([\-\.\/])([0-9]{1,2})\2([0-9]{1,2})$/,parser:function(t){return t?Date.UTC(+t[1],t[3]-1,+t[4]):NaN}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(t){return t?Date.UTC(+t[4],t[3]-1,+t[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{4})$/,parser:function(t){return t?Date.UTC(+t[4],t[1]-1,+t[3]):NaN}},"dd/mm/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(t){var e=new Date;if(!t)return NaN;var r=+t[4];return r>e.getFullYear()-2e3?r+=1900:r+=2e3,Date.UTC(r,t[3]-1,+t[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})([\-\.\/])([0-9]{1,2})\2([0-9]{2})$/,parser:function(t){return t?Date.UTC(+t[4]+2e3,t[1]-1,+t[3]):NaN}}};var r=i(t.defaultOptions,e),o=r.decimalPoint;("."===o||","===o)&&(o="."===o?"\\.":",",this.decimalRegExp=RegExp("^(-?[0-9]+)"+o+"([0-9]+)$")),this.options=r}return t.prototype.asBoolean=function(t){return"boolean"==typeof t?t:"string"==typeof t?""!==t&&"0"!==t&&"false"!==t:!!this.asNumber(t)},t.prototype.asDate=function(t){var e;if("string"==typeof t)e=this.parseDate(t);else if("number"==typeof t)e=t;else{if(t instanceof Date)return t;e=this.parseDate(this.asString(t))}return new Date(e)},t.prototype.asGuessedType=function(t){return({number:this.asNumber,Date:this.asDate,string:this.asString})[this.guessType(t)].call(this,t)},t.prototype.asNumber=function(t){if("number"==typeof t)return t;if("boolean"==typeof t)return t?1:0;if("string"==typeof t){var e=this.decimalRegExp;if(t.indexOf(" ")>-1&&(t=t.replace(/\s+/g,"")),e){if(!e.test(t))return NaN;t=t.replace(e,"$1.$2")}return parseFloat(t)}return t instanceof Date?t.getDate():t?t.getRowCount():NaN},t.prototype.asString=function(t){return""+t},t.prototype.deduceDateFormat=function(t,e,r){var o,n,i,s=[],a=[],u="YYYY/mm/dd",l=[],c=0,f=!1;for((!e||e>t.length)&&(e=t.length);c<e;c++)if(void 0!==t[c]&&t[c]&&t[c].length)for(i=0,o=t[c].trim().replace(/[-\.\/]/g," ").split(" "),l=["","",""];i<o.length;i++)i<l.length&&(n=parseInt(o[i],10))&&(a[i]=!a[i]||a[i]<n?n:a[i],void 0!==s[i]?s[i]!==n&&(s[i]=!1):s[i]=n,n>31?n<100?l[i]="YY":l[i]="YYYY":n>12&&n<=31?(l[i]="dd",f=!0):l[i].length||(l[i]="mm"));if(f){for(i=0;i<s.length;i++)!1!==s[i]?a[i]>12&&"YY"!==l[i]&&"YYYY"!==l[i]&&(l[i]="YY"):a[i]>12&&"mm"===l[i]&&(l[i]="dd");3===l.length&&"dd"===l[1]&&"dd"===l[2]&&(l[2]="YY"),u=l.join("/")}return r&&(this.options.dateFormat=u),u},t.prototype.emit=function(t){o(this,t.type,t)},t.prototype.export=function(t,e){throw this.emit({type:"exportError",columns:[],headers:[]}),Error("Not implemented")},t.prototype.getTable=function(){throw Error("Not implemented")},t.prototype.guessType=function(t){var e="string";if("string"==typeof t){var r=this.trim("".concat(t)),o=this.decimalRegExp,i=this.trim(r,!0);o&&(i=o.test(i)?i.replace(o,"$1.$2"):"");var s=parseFloat(i);+i===s?t=s:e=n(this.parseDate(t))?"Date":"string"}return"number"==typeof t&&(e=t>31536e6?"Date":"number"),e},t.prototype.on=function(t,e){return r(this,t,e)},t.prototype.parse=function(t){throw this.emit({type:"parseError",columns:[],headers:[]}),Error("Not implemented")},t.prototype.parseDate=function(t,e){var r,o,i,s=this.options,a=e||s.dateFormat,u=NaN;if(s.parseDate)u=s.parseDate(t);else{if(a)(o=this.dateFormats[a])||(o=this.dateFormats["YYYY/mm/dd"]),(i=t.match(o.regex))&&(u=o.parser(i));else for(r in this.dateFormats)if(o=this.dateFormats[r],i=t.match(o.regex)){a=r,u=o.parser(i);break}!i&&("object"==typeof(i=Date.parse(t))&&null!==i&&i.getTime?u=i.getTime()-6e4*i.getTimezoneOffset():n(i)&&(u=i-6e4*new Date(i).getTimezoneOffset(),-1===t.indexOf("2001")&&2001===new Date(u).getFullYear()&&(u=NaN)))}return u},t.prototype.trim=function(t,e){return"string"==typeof t&&(t=t.replace(/^\s+|\s+$/g,""),e&&/^[0-9\s]+$/.test(t)&&(t=t.replace(/\s/g,""))),t},t.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:!0,switchRowsAndColumns:!1},t}();return(s||(s={})).getTableFromColumns=function(e,r){void 0===e&&(e=[]),void 0===r&&(r=[]);for(var o=new t,n=0,i=Math.max(r.length,e.length);n<i;++n)o.setColumn(r[n]||"".concat(n),e[n]);return o},s}),r(e,"Data/DataCursor.js",[],function(){var t=function(){function t(t){void 0===t&&(t={}),this.emittingRegister=[],this.listenerMap={},this.stateMap=t}return t.prototype.addListener=function(t,e,r){var o=this.listenerMap[t]=this.listenerMap[t]||{};return(o[e]=o[e]||[]).push(r),this},t.prototype.buildEmittingTag=function(t){return("position"===t.cursor.type?[t.table.id,t.cursor.column,t.cursor.row,t.cursor.state,t.cursor.type]:[t.table.id,t.cursor.columns,t.cursor.firstRow,t.cursor.lastRow,t.cursor.state,t.cursor.type]).join("\0")},t.prototype.emitCursor=function(e,r,o,n){var i,s=e.id,a=r.state,u=this.listenerMap[s]&&this.listenerMap[s][a];if(u){var l=this.stateMap[s]=null!==(i=this.stateMap[s])&&void 0!==i?i:{},c=l[r.state]||[];n&&(c.length||(l[r.state]=c),-1===t.getIndex(r,c)&&c.push(r));var f={cursor:r,cursors:c,table:e};o&&(f.event=o);var p=this.emittingRegister,h=this.buildEmittingTag(f);if(p.indexOf(h)>=0)return this;try{this.emittingRegister.push(h);for(var m=0,d=u.length;m<d;++m)u[m].call(this,f)}finally{var g=this.emittingRegister.indexOf(h);g>=0&&this.emittingRegister.splice(g,1)}}return this},t.prototype.remitCursor=function(e,r){var o=this.stateMap[e]&&this.stateMap[e][r.state];if(o){var n=t.getIndex(r,o);n>=0&&o.splice(n,1)}return this},t.prototype.removeListener=function(t,e,r){var o=this.listenerMap[t]&&this.listenerMap[t][e];if(o){var n=o.indexOf(r);n>=0&&o.splice(n,1)}return this},t.version="1.0.0",t}();return function(t){function e(t,e){if("range"===t.type)return t;var r,o,n,i,s={type:"range",firstRow:null!==(o=null!==(r=t.row)&&void 0!==r?r:e&&e.firstRow)&&void 0!==o?o:0,lastRow:null!==(i=null!==(n=t.row)&&void 0!==n?n:e&&e.lastRow)&&void 0!==i?i:Number.MAX_VALUE,state:t.state};return void 0!==t.column&&(s.columns=[t.column]),s}t.getIndex=function(t,e){if("position"===t.type){for(var r=void 0,o=0,n=e.length;o<n;++o)if("position"===(r=e[o]).type&&r.state===t.state&&r.column===t.column&&r.row===t.row)return o}else for(var i=JSON.stringify(t.columns),r=void 0,o=0,n=e.length;o<n;++o)if("range"===(r=e[o]).type&&r.state===t.state&&r.firstRow===t.firstRow&&r.lastRow===t.lastRow&&JSON.stringify(r.columns)===i)return o;return -1},t.isEqual=function(t,e){return"position"===t.type&&"position"===e.type?t.column===e.column&&t.row===e.row&&t.state===e.state:"range"===t.type&&"range"===e.type&&t.firstRow===e.firstRow&&t.lastRow===e.lastRow&&JSON.stringify(t.columns)===JSON.stringify(e.columns)},t.isInRange=function(t,r){"position"===r.type&&(r=e(r)),"position"===t.type&&(t=e(t,r));var o=t.columns,n=r.columns;return t.firstRow>=r.firstRow&&t.lastRow<=r.lastRow&&(!o||!n||o.every(function(t){return n.indexOf(t)>=0}))},t.toPositions=function(t){if("position"===t.type)return[t];for(var e=t.columns||[],r=[],o=t.state,n=t.firstRow,i=t.lastRow;n<i;++n){if(!e.length){r.push({type:"position",row:n,state:o});continue}for(var s=0,a=e.length;s<a;++s)r.push({type:"position",column:e[s],row:n,state:o})}return r},t.toRange=e}(t||(t={})),t}),r(e,"Data/DataPoolDefaults.js",[],function(){return{connectors:[]}}),r(e,"Data/DataPool.js",[e["Data/Connectors/DataConnector.js"],e["Data/DataPoolDefaults.js"],e["Core/Utilities.js"]],function(t,e,r){return function(){function o(t){void 0===t&&(t=e),t.connectors=t.connectors||[],this.connectors={},this.options=t,this.waiting={}}return o.prototype.emit=function(t){r.fireEvent(this,t.type,t)},o.prototype.getConnector=function(t){var e=this,r=this.connectors[t];if(r)return Promise.resolve(r);var o=this.waiting[t];if(!o){o=this.waiting[t]=[];var n=this.getConnectorOptions(t);if(!n)throw Error("Connector '".concat(t,"' not found."));this.loadConnector(n).then(function(r){delete e.waiting[t];for(var n=0,i=o.length;n<i;++n)o[n][0](r)}).catch(function(r){delete e.waiting[t];for(var n=0,i=o.length;n<i;++n)o[n][1](r)})}return new Promise(function(t,e){o.push([t,e])})},o.prototype.getConnectorIds=function(){for(var t=this.options.connectors,e=[],r=0,o=t.length;r<o;++r)e.push(t[r].id);return e},o.prototype.getConnectorOptions=function(t){for(var e=this.options.connectors,r=0,o=e.length;r<o;++r)if(e[r].id===t)return e[r]},o.prototype.getConnectorTable=function(t){return this.getConnector(t).then(function(t){return t.table})},o.prototype.isNewConnector=function(t){return!this.connectors[t]},o.prototype.loadConnector=function(e){var r=this;return new Promise(function(o,n){r.emit({type:"load",options:e});var i=t.types[e.type];if(!i)throw Error("Connector type not found. (".concat(e.type,")"));new i(e.options).load().then(function(t){r.connectors[e.id]=t,r.emit({type:"afterLoad",options:e}),o(t)}).catch(n)})},o.prototype.on=function(t,e){return r.addEvent(this,t,e)},o.prototype.setConnectorOptions=function(t){var e=this.options.connectors,r=this.connectors;this.emit({type:"setConnectorOptions",options:t});for(var o=0,n=e.length;o<n;++o)if(e[o].id===t.id){e.splice(o,1);break}r[t.id]&&(r[t.id].stopPolling(),delete r[t.id]),e.push(t),this.emit({type:"afterSetConnectorOptions",options:t})},o.version="1.0.0",o}()}),r(e,"Data/Formula/FormulaParser.js",[],function(){var t=/^(?:FALSE|TRUE)/,e=/^[+-]?\d+(?:\.\d+)?(?:e[+-]\d+)?/,r=/^[+-]?\d+(?:,\d+)?(?:e[+-]\d+)?/,o=/^([A-Z][A-Z\d\.]*)\(/,n=/^(?:[+\-*\/^<=>]|<=|=>)/,i=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/,s=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/,a=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/,u=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function l(t){for(var e=0,r=0,o=t.length,n=void 0,i=1;r<o;++r){if("("===(n=t[r])){e||(i=r+1),++e;continue}if(")"===n&&!--e)return t.substring(i,r)}if(e>0){var s=Error("Incomplete parantheses.");throw s.name="FormulaParseError",s}return""}function c(t){for(var e=-1,r=0,o=t.length,n=void 0,i=!1;r<o;++r){if("\\"===(n=t[r])){i=!i;continue}if(i){i=!1;continue}if('"'===n){if(!(e<0))return t.substring(e+1,r);e=r}}var s=Error("Incomplete string.");throw s.name="FormulaParseError",s}function f(t,e){if(r=t.match(s)){var r,o=""===r[2]||"["===r[2][0],n=""===r[1]||"["===r[1][0],a=""===r[4]||"["===r[4][0],u=""===r[3]||"["===r[3][0],l={type:"range",beginColumn:o?parseInt(r[2].substring(1,-1)||"0",10):parseInt(r[2],10)-1,beginRow:n?parseInt(r[1].substring(1,-1)||"0",10):parseInt(r[1],10)-1,endColumn:a?parseInt(r[4].substring(1,-1)||"0",10):parseInt(r[4],10)-1,endRow:u?parseInt(r[3].substring(1,-1)||"0",10):parseInt(r[3],10)-1};return o&&(l.beginColumnRelative=!0),n&&(l.beginRowRelative=!0),a&&(l.endColumnRelative=!0),u&&(l.endRowRelative=!0),l}if(r=t.match(i)){var o="$"!==r[1][0],n="$"!==r[2][0],a="$"!==r[3][0],u="$"!==r[4][0],l={type:"range",beginColumn:h(o?r[1]:r[1].substring(1))-1,beginRow:parseInt(n?r[2]:r[2].substring(1),10)-1,endColumn:h(a?r[3]:r[3].substring(1))-1,endRow:parseInt(u?r[4]:r[4].substring(1),10)-1};return o&&(l.beginColumnRelative=!0),n&&(l.beginRowRelative=!0),a&&(l.endColumnRelative=!0),u&&(l.endRowRelative=!0),l}var c=p(t,e);return 1===c.length&&"string"!=typeof c[0]?c[0]:c}function p(i,s){for(var m,d=s?r:e,g=[],y=("="===i[0]?i.substring(1):i).trim();y;){if(m=y.match(u)){var v=""===m[2]||"["===m[2][0],b=""===m[1]||"["===m[1][0],C={type:"reference",column:v?parseInt(m[2].substring(1,-1)||"0",10):parseInt(m[2],10)-1,row:b?parseInt(m[1].substring(1,-1)||"0",10):parseInt(m[1],10)-1};v&&(C.columnRelative=!0),b&&(C.rowRelative=!0),g.push(C),y=y.substring(m[0].length).trim();continue}if(m=y.match(a)){var v="$"!==m[1][0],b="$"!==m[2][0],C={type:"reference",column:h(v?m[1]:m[1].substring(1))-1,row:parseInt(b?m[2]:m[2].substring(1),10)-1};v&&(C.columnRelative=!0),b&&(C.rowRelative=!0),g.push(C),y=y.substring(m[0].length).trim();continue}if(m=y.match(n)){g.push(m[0]),y=y.substring(m[0].length).trim();continue}if(m=y.match(t)){g.push("TRUE"===m[0]),y=y.substring(m[0].length).trim();continue}if(m=y.match(d)){g.push(parseFloat(m[0])),y=y.substring(m[0].length).trim();continue}if('"'===y[0]){var w=c(y);g.push(w.substring(1,-1)),y=y.substring(w.length+2).trim();continue}if(m=y.match(o)){var j=l(y=y.substring(m[1].length).trim());g.push({type:"function",name:m[1],args:function(t,e){for(var r=[],o=e?";":",",n=0,i="",s=0,a=t.length,u=void 0;s<a;++s)if((u=t[s])===o&&!n&&i)r.push(f(i,e)),i="";else if('"'!==u||n||i)" "!==u&&(i+=u,"("===u?++n:")"===u&&--n);else{var l=c(t.substring(s));r.push(l),s+=l.length+1}return!n&&i&&r.push(f(i,e)),r}(j,s)}),y=y.substring(j.length+2).trim();continue}if("("===y[0]){var D=l(y);if(D){g.push(p(D,s)),y=y.substring(D.length+2).trim();continue}}var O=i.length-y.length,N=Error("Unexpected character `"+i.substring(O,O+1)+"` at position "+(O+1)+". (`..."+i.substring(O-5,O+6)+"...`)");throw N.name="FormulaParseError",N}return g}function h(t){for(var e=0,r=0,o=t.length,n=void 0,i=t.length-1;r<o;++r)(n=t.charCodeAt(r))>=65&&n<=90&&(e+=(n-64)*Math.pow(26,i)),--i;return e}return{parseFormula:p}}),r(e,"Data/Formula/FormulaTypes.js",[],function(){var t=["+","-","*","/","^","=","<","<=",">",">="];return{isFormula:function(t){return t instanceof Array},isFunction:function(t){return"object"==typeof t&&!(t instanceof Array)&&"function"===t.type},isOperator:function(e){return"string"==typeof e&&t.indexOf(e)>=0},isRange:function(t){return"object"==typeof t&&!(t instanceof Array)&&"range"===t.type},isReference:function(t){return"object"==typeof t&&!(t instanceof Array)&&"reference"===t.type},isValue:function(t){return"boolean"==typeof t||"number"==typeof t||"string"==typeof t}}}),r(e,"Data/Formula/FormulaProcessor.js",[e["Data/Formula/FormulaTypes.js"]],function(t){var e=t.isFormula,r=t.isFunction,o=t.isOperator,n=t.isRange,i=t.isReference,s=t.isValue,a=/ */,u=Number.MAX_VALUE/1.000000000001,l=Number.MAX_VALUE/1.000000000002,c=Number.MAX_VALUE,f={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0},p={},h=/^[A-Z][A-Z\.]*$/;function m(t){switch(typeof t){case"boolean":return t?c:u;case"string":return l;case"number":return t;default:return NaN}}function d(t){return"string"==typeof t?t.toLowerCase().replace(a,"\0"):t}function g(t){switch(typeof t){case"boolean":return t?1:0;case"string":return parseFloat(t.replace(",","."));case"number":return t;default:return NaN}}function y(t,e,r){var o;switch(t){case"=":return d(e)===d(r);case"<":if(typeof e==typeof r)return d(e)<d(r);return m(e)<m(r);case"<=":if(typeof e==typeof r)return d(e)<=d(r);return m(e)<=m(r);case">":if(typeof e==typeof r)return d(e)>d(r);return m(e)>m(r);case">=":if(typeof e==typeof r)return d(e)>=d(r);return m(e)>=m(r)}switch(e=g(e),r=g(r),t){case"+":o=e+r;break;case"-":o=e-r;break;case"*":o=e*r;break;case"/":o=e/r;break;case"^":o=Math.pow(e,r);break;default:return NaN}return o%1?Math.round(1e9*o)/1e9:o}function v(t,o){return s(t)?t:n(t)?o&&b(t,o)||[]:r(t)?j(t,o):w(e(t)?t:[t],o)}function b(t,e){for(var r=e.getColumnNames().slice(t.beginColumn,t.endColumn+1),o=[],n=0,i=r.length,a=void 0;n<i;++n)for(var u=e.getColumn(r[n],!0)||[],l=t.beginRow,c=t.endRow+1;l<c;++l)"string"==typeof(a=u[l])&&"="===a[0]&&e!==e.modified&&(a=e.modified.getCell(r[n],l)),o.push(s(a)?a:NaN);return o}function C(t,e){var r=e.getColumnNames()[t.column];if(r){var o=e.getCell(r,t.row);if("string"==typeof o&&"="===o[0]&&e!==e.modified){var n=e.modified.getCell(r,t.row);return s(n)?n:NaN}return s(o)?o:NaN}return NaN}function w(t,n){for(var a,u=0,l=t.length,c=void 0,p=void 0,h=void 0,m=void 0;u<l;++u){if(o(c=t[u])){p=c;continue}if(s(c)?m=c:e(c)?m=w(t,n):r(c)?m=s(h=j(c,n))?h:NaN:i(c)&&(m=n&&C(c,n)),void 0!==m){if(void 0===a)a=p?y(p,0,m):m;else{if(!p)return NaN;var d=t[u+1];o(d)&&f[d]>f[p]&&(m=y(d,m,w(t.slice(u+2))),u=l),a=y(p,a,m)}p=void 0,m=void 0}}return s(a)?a:NaN}function j(t,e,r){var o=p[t.name];if(o)try{return o(t.args,e)}catch(t){return NaN}var n=Error('Function "'.concat(t.name,'" not found.'));throw n.name="FormulaProcessError",n}return{asNumber:g,getArgumentValue:v,getArgumentsValues:function(t,e){for(var r=[],o=0,n=t.length;o<n;++o)r.push(v(t[o],e));return r},getRangeValues:b,getReferenceValue:C,processFormula:w,processorFunctions:p,registerProcessorFunction:function(t,e){return h.test(t)&&!p[t]&&!!(p[t]=e)},translateReferences:function t(e,o,s){void 0===o&&(o=0),void 0===s&&(s=0);for(var a=0,u=e.length,l=void 0;a<u;++a)(l=e[a])instanceof Array?t(l,o,s):r(l)?t(l.args,o,s):n(l)?(l.beginColumnRelative&&(l.beginColumn+=o),l.beginRowRelative&&(l.beginRow+=s),l.endColumnRelative&&(l.endColumn+=o),l.endRowRelative&&(l.endRow+=s)):i(l)&&(l.columnRelative&&(l.column+=o),l.rowRelative&&(l.row+=s));return e}}}),r(e,"Data/Formula/Functions/ABS.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,r){var o=e(t[0],r);switch(typeof o){case"number":return Math.abs(o);case"object":for(var n=[],i=0,s=o.length,a=void 0;i<s;++i){if("number"!=typeof(a=o[i]))return NaN;n.push(Math.abs(a))}return n;default:return NaN}}return t.registerProcessorFunction("ABS",r),r}),r(e,"Data/Formula/Functions/AND.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,o){for(var n=0,i=t.length,s=void 0;n<i;++n)if(!(s=e(t[n],o))||"object"==typeof s&&!r(s,o))return!1;return!0}return t.registerProcessorFunction("AND",r),r}),r(e,"Data/Formula/Functions/AVERAGE.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentsValues;function r(t,r){for(var o=e(t,r),n=0,i=0,s=0,a=o.length,u=void 0;s<a;++s)switch(typeof(u=o[s])){case"number":isNaN(u)||(++n,i+=u);break;case"object":for(var l=0,c=u.length,f=void 0;l<c;++l)"number"!=typeof(f=u[l])||isNaN(f)||(++n,i+=f)}return n?i/n:0}return t.registerProcessorFunction("AVERAGE",r),r}),r(e,"Data/Formula/Functions/AVERAGEA.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,r){for(var o=0,n=0,i=0,s=t.length,a=void 0;i<s;++i)switch(typeof(a=e(t[i],r))){case"boolean":++o,n+=a?1:0;continue;case"number":isNaN(a)||(++o,n+=a);continue;case"string":++o;continue;default:for(var u=0,l=a.length,c=void 0;u<l;++u)switch(typeof(c=a[u])){case"boolean":++o,n+=c?1:0;continue;case"number":isNaN(c)||(++o,n+=c);continue;case"string":++o;continue}continue}return o?n/o:0}return t.registerProcessorFunction("AVERAGEA",r),r}),r(e,"Data/Formula/Functions/COUNT.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function e(r,o){for(var n=t.getArgumentsValues(r,o),i=0,s=0,a=n.length,u=void 0;s<a;++s)switch(typeof(u=n[s])){case"number":!isNaN(u)&&++i;break;case"object":i+=e(u,o)}return i}return t.registerProcessorFunction("COUNT",e),e}),r(e,"Data/Formula/Functions/COUNTA.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function e(r,o){for(var n=t.getArgumentsValues(r,o),i=0,s=0,a=n.length,u=void 0;s<a;++s){switch(typeof(u=n[s])){case"number":if(isNaN(u))continue;break;case"object":i+=e(u,o);continue;case"string":if(!u)continue}++i}return i}return t.registerProcessorFunction("COUNTA",e),e}),r(e,"Data/Formula/Functions/IF.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,r){return e(t[0],r)?e(t[1],r):e(t[2],r)}return t.registerProcessorFunction("IF",r),r}),r(e,"Data/Formula/Functions/ISNA.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,r){var o=e(t[0],r);return"number"!=typeof o||isNaN(o)}return t.registerProcessorFunction("ISNA",r),r}),r(e,"Data/Formula/Functions/MAX.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentsValues;function r(t,o){for(var n=e(t,o),i=Number.NEGATIVE_INFINITY,s=0,a=n.length,u=void 0;s<a;++s)switch(typeof(u=n[s])){case"number":u>i&&(i=u);break;case"object":(u=r(u))>i&&(i=u)}return isFinite(i)?i:0}return t.registerProcessorFunction("MAX",r),r}),r(e,"Data/Formula/Functions/MEDIAN.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function e(e,r){for(var o=[],n=t.getArgumentsValues(e,r),i=0,s=n.length,a=void 0;i<s;++i)switch(typeof(a=n[i])){case"number":isNaN(a)||o.push(a);break;case"object":for(var u=0,l=a.length,c=void 0;u<l;++u)"number"!=typeof(c=a[u])||isNaN(c)||o.push(c)}var f=o.length;if(!f)return NaN;var p=Math.floor(f/2);return f%2?o[p]:(o[p-1]+o[p])/2}return t.registerProcessorFunction("MEDIAN",e),e}),r(e,"Data/Formula/Functions/MIN.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentsValues;function r(t,o){for(var n=e(t,o),i=Number.POSITIVE_INFINITY,s=0,a=n.length,u=void 0;s<a;++s)switch(typeof(u=n[s])){case"number":u<i&&(i=u);break;case"object":(u=r(u))<i&&(i=u)}return isFinite(i)?i:0}return t.registerProcessorFunction("MIN",r),r}),r(e,"Data/Formula/Functions/MOD.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,r){var o=e(t[0],r),n=e(t[1],r);return("object"==typeof o&&(o=o[0]),"object"==typeof n&&(n=n[0]),"number"!=typeof o||"number"!=typeof n||0===n)?NaN:o%n}return t.registerProcessorFunction("MOD",r),r}),r(e,"Data/Formula/Functions/MODE.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function e(e,r){for(var o={},n=t.getArgumentsValues(e,r),i=0,s=n.length,a=void 0;i<s;++i)switch(typeof(a=n[i])){case"number":isNaN(a)||(o[a]=(o[a]||0)+1);break;case"object":for(var u=0,l=a.length,c=void 0;u<l;++u)"number"!=typeof(c=a[u])||isNaN(c)||(o[c]=(o[c]||0)+1)}return o}function r(t,r){var o=e(t,r),n=Object.keys(o);if(!n.length)return NaN;for(var i=[parseFloat(n[0])],s=o[n[0]],a=1,u=n.length,l=void 0,c=void 0;a<u;++a)s<(c=o[l=n[a]])?(i=[parseFloat(l)],s=c):s===c&&i.push(parseFloat(l));return s>1?i:NaN}function o(t,r){var o=e(t,r),n=Object.keys(o);if(!n.length)return NaN;for(var i=parseFloat(n[0]),s=o[n[0]],a=1,u=n.length,l=void 0,c=void 0,f=void 0;a<u;++a)s<(f=o[l=n[a]])?(i=parseFloat(l),s=f):s===f&&i>(c=parseFloat(l))&&(i=c,s=f);return s>1?i:NaN}return t.registerProcessorFunction("MODE",o),t.registerProcessorFunction("MODE.MULT",r),t.registerProcessorFunction("MODE.SNGL",o),{MULT:r,SNGL:o}}),r(e,"Data/Formula/Functions/NOT.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,r){var o=e(t[0],r);switch("object"==typeof o&&(o=o[0]),typeof o){case"boolean":case"number":return!o}return NaN}return t.registerProcessorFunction("NOT",r),r}),r(e,"Data/Formula/Functions/OR.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,o){for(var n=0,i=t.length,s=void 0;n<i;++n)if("object"==typeof(s=e(t[n],o))){if(r(s,o))return!0}else if(s)return!0;return!1}return t.registerProcessorFunction("OR",r),r}),r(e,"Data/Formula/Functions/PRODUCT.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentsValues;function r(t,o){for(var n=e(t,o),i=1,s=!1,a=0,u=n.length,l=void 0;a<u;++a)switch(typeof(l=n[a])){case"number":isNaN(l)||(s=!0,i*=l);break;case"object":s=!0,i*=r(l,o)}return s?i:0}return t.registerProcessorFunction("PRODUCT",r),r}),r(e,"Data/Formula/Functions/SUM.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){function e(r,o){for(var n=t.getArgumentsValues(r,o),i=0,s=0,a=n.length,u=void 0;s<a;++s)switch(typeof(u=n[s])){case"number":isNaN(u)||(i+=u);break;case"object":i+=e(u,o)}return i}return t.registerProcessorFunction("SUM",e),e}),r(e,"Data/Formula/Functions/XOR.js",[e["Data/Formula/FormulaProcessor.js"]],function(t){var e=t.getArgumentValue;function r(t,r){for(var o=0,n=t.length,i=void 0,s=void 0;o<n;++o)switch(typeof(s=e(t[o],r))){case"boolean":case"number":if(void 0===i)i=!!s;else if(!!s!==i)return!0;break;case"object":for(var a=0,u=s.length,l=void 0;a<u;++a)switch(typeof(l=s[a])){case"boolean":case"number":if(void 0===i)i=!!l;else if(!!l!==i)return!0}}return!1}return t.registerProcessorFunction("XOR",r),r}),r(e,"Data/Formula/Formula.js",[e["Data/Formula/FormulaParser.js"],e["Data/Formula/FormulaProcessor.js"],e["Data/Formula/FormulaTypes.js"]],function(t,e,r){var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};return o(o(o({},t),e),r)}),r(e,"Data/Converters/CSVConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(t,e){var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},i=e.merge;return function(e){function r(t){var o=this,n=i(r.defaultOptions,t);return(o=e.call(this,n)||this).columns=[],o.headers=[],o.dataTypes=[],o.options=n,o}return o(r,e),r.prototype.export=function(t,e){void 0===e&&(e=this.options);var r=e.useLocalDecimalPoint,o=e.lineDelimiter,n=!1!==this.options.firstRowAsNames,i=e.decimalPoint,s=e.itemDelimiter;i||(i=","!==s&&r?1.1.toLocaleString()[1]:"."),s||(s=","===i?";":",");var a=t.getSortedColumns(e.usePresentationOrder),u=Object.keys(a),l=[],c=u.length,f=[];n&&l.push(u.map(function(t){return'"'.concat(t,'"')}).join(s));for(var p=0;p<c;p++){var h=u[p],m=a[h],d=m.length,g=t.whatIs(h),y=void 0;g&&(y=g.dataType);for(var v=0;v<d;v++){var b=m[v];if(f[v]||(f[v]=[]),"string"===y?b='"'+b+'"':"number"==typeof b?b=String(b).replace(".",i):"string"==typeof b&&(b='"'.concat(b,'"')),f[v][p]=b,p===c-1){for(var C=p;f[v].length>2&&void 0===f[v][C];)f[v].pop(),C--;l.push(f[v].join(s))}}}return l.join(o)},r.prototype.parse=function(t,e){var r,o,n=this.dataTypes,s=i(this.options,t),a=s.beforeParse,u=s.lineDelimiter,l=s.firstRowAsNames,c=s.itemDelimiter,f=0,p=s.csv,h=s.startRow,m=s.endRow;if(this.columns=[],this.emit({type:"parse",columns:this.columns,detail:e,headers:this.headers}),p&&a&&(p=a(p)),p){if(r=p.replace(/\r\n|\r/g,"\n").split(u||"\n"),(!h||h<0)&&(h=0),(!m||m>=r.length)&&(m=r.length-1),c||(this.guessedItemDelimiter=this.guessDelimiter(r)),l){for(var d=r[0].split(c||this.guessedItemDelimiter||","),g=0;g<d.length;g++)d[g]=d[g].trim().replace(/^["']|["']$/g,"");this.headers=d,h++}var y=0;for(f=h;f<=m;f++)"#"===r[f][0]?y++:this.parseCSVRow(r[f],f-h-y);n.length&&n[0].length&&"date"===n[0][1]&&!this.options.dateFormat&&this.deduceDateFormat(this.columns[0],null,!0);for(var g=0,v=this.columns.length;g<v;++g){o=this.columns[g];for(var b=0,C=o.length;b<C;++b)if(o[b]&&"string"==typeof o[b]){var w=this.asGuessedType(o[b]);w instanceof Date&&(w=w.getTime()),this.columns[g][b]=w}}}this.emit({type:"afterParse",columns:this.columns,detail:e,headers:this.headers})},r.prototype.parseCSVRow=function(t,e){var r=this,o=r.columns||[],n=r.dataTypes,i=r.options,s=i.startColumn,a=i.endColumn,u=r.options.itemDelimiter||r.guessedItemDelimiter,l=r.options.decimalPoint;l&&l!==u||(l=r.guessedDecimalPoint||".");var c=0,f="",p="",h=0,m=0,d=function(e){f=t[e]},g=function(t){n.length<m+1&&n.push([t]),n[m][n[m].length-1]!==t&&n[m].push(t)},y=function(){if(s>h||h>a){++h,p="";return}if("string"==typeof p?!isNaN(parseFloat(p))&&isFinite(p)?(p=parseFloat(p),g("number")):isNaN(Date.parse(p))?g("string"):(p=p.replace(/\//g,"-"),g("date")):g("number"),o.length<m+1&&o.push([]),"number"!=typeof p&&"number"!==r.guessType(p)&&l){var t=p;p=p.replace(l,"."),"number"!==r.guessType(p)&&(p=t)}o[m][e]=p,p="",++m,++h};if(t.trim().length&&"#"!==t.trim()[0]){for(;c<t.length;c++){if(d(c),"#"===f&&!/^#[0-9a-f]{3,3}|[0-9a-f]{6,6}/i.test(t.substring(c))){y();return}if('"'===f)for(d(++c);c<t.length&&'"'!==f;)p+=f,d(++c);else f===u?y():p+=f}y()}},r.prototype.guessDelimiter=function(t){for(var e,r=0,o=0,n={",":0,";":0,"	":0},i=t.length,s=0;s<i;s++){var a=!1,u=void 0,l=void 0,c=void 0,f="";if(s>13)break;for(var p=t[s],h=0;h<p.length&&(u=p[h],l=p[h+1],c=p[h-1],"#"!==u);h++){if('"'===u){if(a){if('"'!==c&&'"'!==l){for(;" "===l&&h<p.length;)l=p[++h];void 0!==n[l]&&n[l]++,a=!1}}else a=!0}else void 0!==n[u]?(isNaN(Date.parse(f=f.trim()))?(isNaN(Number(f))||!isFinite(Number(f)))&&n[u]++:n[u]++,f=""):f+=u;","===u&&o++,"."===u&&r++}}return n[";"]>n[","]?e=";":(n[","],n[";"],e=","),r>o?this.guessedDecimalPoint=".":this.guessedDecimalPoint=",",e},r.prototype.getTable=function(){return t.getTableFromColumns(this.columns,this.headers)},r.defaultOptions=n(n({},t.defaultOptions),{lineDelimiter:"\n"}),r}(t)}),r(e,"Data/Connectors/CSVConnector.js",[e["Data/Converters/CSVConverter.js"],e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"]],function(t,e,r){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=r.merge,s=function(e){function r(o){var n=this,s=i(r.defaultOptions,o);return(n=e.call(this,s)||this).converter=new t(s),n.options=s,s.enablePolling&&n.startPolling(1e3*Math.max(s.dataRefreshRate||0,1)),n}return n(r,e),r.prototype.load=function(t){var e=this,r=e.converter,o=e.table,n=e.options,i=n.csv,s=n.csvURL,a=n.dataModifier;return e.emit({type:"load",csv:i,detail:t,table:o}),Promise.resolve(s?fetch(s).then(function(t){return t.text()}):i||"").then(function(t){return t&&(o.deleteColumns(),r.parse({csv:t}),o.setColumns(r.getTable().getColumns())),e.setModifierOptions(a).then(function(){return t})}).then(function(r){return e.emit({type:"afterLoad",csv:r,detail:t,table:o}),e}).catch(function(r){throw e.emit({type:"loadError",detail:t,error:r,table:o}),r})},r.defaultOptions={csv:"",csvURL:"",enablePolling:!1,dataRefreshRate:1,firstRowAsNames:!0},r}(e);return e.registerType("CSV",s),s}),r(e,"Data/Converters/JSONConverter.js",[e["Data/Converters/DataConverter.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(t,e,r){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},s=r.error,a=r.isArray,u=r.merge,l=r.objectEach;return function(r){function o(t){var n=this,i=u(o.defaultOptions,t);return(n=r.call(this,i)||this).columns=[],n.headers=[],n.options=i,n.table=new e,n}return n(o,r),o.prototype.parse=function(t,e){var r=this,o=(t=u(r.options,t)).beforeParse,n=t.orientation,i=t.firstRowAsNames,c=t.columnNames,f=t.data;if(f){if(r.columns=[],r.emit({type:"parse",columns:r.columns,detail:e,headers:r.headers}),o&&(f=o(f)),f=f.slice(),"columns"===n)for(var p=0,h=f.length;p<h;p++){var m=f[p];if(!(m instanceof Array))return;r.headers instanceof Array?(i?r.headers.push("".concat(m.shift())):c&&c instanceof Array&&r.headers.push(c[p]),r.table.setColumn(r.headers[p]||p.toString(),m)):s("JSONConverter: Invalid `columnNames` option.",!1)}else if("rows"===n){i?r.headers=f.shift():c&&(r.headers=c);for(var d=this,g=0,h=f.length;g<h;g++)!function(t,e){var o=f[t];if(a(o))for(var n=0,i=o.length;n<i;n++)r.columns.length<n+1&&r.columns.push([]),r.columns[n].push(o[n]),r.headers instanceof Array?d.table.setColumn(r.headers[n]||n.toString(),r.columns[n]):s("JSONConverter: Invalid `columnNames` option.",!1);else{var u=r.headers;if(u&&!(u instanceof Array)){var c={};l(u,function(t,e){c[e]=t.reduce(function(t,e){return t[e]},o)}),o=c}d.table.setRows([o],t)}}(g,0)}r.emit({type:"afterParse",columns:r.columns,detail:e,headers:r.headers})}},o.prototype.getTable=function(){return this.table},o.defaultOptions=i(i({},t.defaultOptions),{data:[],orientation:"rows"}),o}(t)}),r(e,"Data/Connectors/JSONConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Utilities.js"],e["Data/Converters/JSONConverter.js"]],function(t,e,r){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=e.merge,s=function(t){function e(o){var n=this,s=i(e.defaultOptions,o);return(n=t.call(this,s)||this).converter=new r(s),n.options=s,s.enablePolling&&n.startPolling(1e3*Math.max(s.dataRefreshRate||0,1)),n}return n(e,t),e.prototype.load=function(t){var e=this,r=e.converter,o=e.table,n=e.options,i=n.data,s=n.dataUrl,a=n.dataModifier;return e.emit({type:"load",data:i,detail:t,table:o}),Promise.resolve(s?fetch(s).then(function(t){return t.json()}):i||[]).then(function(t){return t&&(o.deleteColumns(),r.parse({data:t}),o.setColumns(r.getTable().getColumns())),e.setModifierOptions(a).then(function(){return t})}).then(function(r){return e.emit({type:"afterLoad",data:r,detail:t,table:o}),e}).catch(function(r){throw e.emit({type:"loadError",detail:t,error:r,table:o}),r})},e.defaultOptions={data:[],enablePolling:!1,dataRefreshRate:0,firstRowAsNames:!0,orientation:"rows"},e}(t);return t.registerType("JSON",s),s}),r(e,"Data/Converters/GoogleSheetsConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(t,e){var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},i=e.merge,s=e.uniqueKey;return function(e){function r(t){var o=this,n=i(r.defaultOptions,t);return(o=e.call(this,n)||this).columns=[],o.header=[],o.options=n,o}return o(r,e),r.prototype.parse=function(t,e){var r,o=i(this.options,t),n=(o.json&&o.json.values||[]).map(function(t){return t.slice()});if(0===n.length)return!1;this.header=[],this.columns=[],this.emit({type:"parse",columns:this.columns,detail:e,headers:this.header}),this.columns=n;for(var a=0,u=n.length;a<u;a++){r=n[a],this.header[a]=o.firstRowAsNames?"".concat(r.shift()):s();for(var l=0,c=r.length;l<c;++l)if(r[l]&&"string"==typeof r[l]){var f=this.asGuessedType(r[l]);f instanceof Date&&(f=f.getTime()),this.columns[a][l]=f}}this.emit({type:"afterParse",columns:this.columns,detail:e,headers:this.header})},r.prototype.getTable=function(){return t.getTableFromColumns(this.columns,this.header)},r.defaultOptions=n({},t.defaultOptions),r}(t)}),r(e,"Data/Connectors/GoogleSheetsConnector.js",[e["Data/Connectors/DataConnector.js"],e["Data/Converters/GoogleSheetsConverter.js"],e["Core/Utilities.js"]],function(t,e,r){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=r.merge,s=r.pick,a=function(t){function r(o){var n=this,s=i(r.defaultOptions,o);return(n=t.call(this,s)||this).converter=new e(s),n.options=s,n}return n(r,t),r.prototype.load=function(t){var e=this,o=e.converter,n=e.table,i=e.options,s=i.dataModifier,a=i.dataRefreshRate,u=i.enablePolling,l=i.firstRowAsNames,c=i.googleAPIKey,f=i.googleSpreadsheetKey,p=r.buildFetchURL(c,f,e.options);return e.emit({type:"load",detail:t,table:n,url:p}),fetch(p).then(function(t){return t.json()}).then(function(t){if("object"==typeof t&&t&&"object"==typeof t.error&&t.error&&"number"==typeof t.error.code&&"string"==typeof t.error.message&&"string"==typeof t.error.status)throw Error(t.error.message);return o.parse({firstRowAsNames:l,json:t}),n.deleteColumns(),n.setColumns(o.getTable().getColumns()),e.setModifierOptions(s)}).then(function(){return e.emit({type:"afterLoad",detail:t,table:n,url:p}),u&&setTimeout(function(){return e.load()},1e3*Math.max(a||0,1)),e}).catch(function(r){throw e.emit({type:"loadError",detail:t,error:r,table:n}),r})},r.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",worksheet:1,enablePolling:!1,dataRefreshRate:2,firstRowAsNames:!0},r}(t);return function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function r(t){void 0===t&&(t={});var r=t.endColumn,o=t.endRow,n=t.googleSpreadsheetRange,i=t.startColumn,a=t.startRow;return n||(e[i||0]||"A")+(Math.max(a||0,0)+1)+":"+(e[s(r,25)]||"Z")+(o?Math.max(o,0):"Z")}t.buildFetchURL=function(t,e,o){return void 0===o&&(o={}),"https://sheets.googleapis.com/v4/spreadsheets/".concat(e,"/values/")+(o.onlyColumnNames?"A1:Z1":r(o))+"?alt=json"+(o.onlyColumnNames?"":"&dateTimeRenderOption=FORMATTED_STRING&majorDimension=COLUMNS&valueRenderOption=UNFORMATTED_VALUE")+"&prettyPrint=false"+"&key=".concat(t)},t.buildQueryRange=r}(a||(a={})),t.registerType("GoogleSheets",a),a}),r(e,"Data/Converters/HTMLTableConverter.js",[e["Data/Converters/DataConverter.js"],e["Core/Utilities.js"]],function(t,e){var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},i=e.merge;return function(e){function r(t){var o=this,n=i(r.defaultOptions,t);return(o=e.call(this,n)||this).columns=[],o.headers=[],o.options=n,n.tableElement&&(o.tableElement=n.tableElement,o.tableElementID=n.tableElement.id),o}return o(r,e),r.prototype.export=function(t,e){void 0===e&&(e=this.options);var r=!1!==e.firstRowAsNames,o=e.useMultiLevelHeaders,n=t.getSortedColumns(e.usePresentationOrder),i=Object.keys(n),s=[],a=i.length,u=[],l="";if(r){var c=[];if(o){for(var f=0;f<i.length;f++){var p=(n[i[f]].shift()||"").toString();c.push(p)}l=this.getTableHeaderHTML(i,c,e)}else l=this.getTableHeaderHTML(void 0,i,e)}for(var h=0;h<a;h++)for(var m=n[i[h]],d=m.length,g=0;g<d;g++){var y=m[g];u[g]||(u[g]=[]),"string"==typeof y||"number"==typeof y||void 0===y||(y=(y||"").toString()),u[g][h]=this.getCellHTMLFromValue(h?"td":"th",null,h?"":'scope="row"',y),h===a-1&&s.push("<tr>"+u[g].join("")+"</tr>")}var v="";return e.tableCaption&&(v='<caption class="highcharts-table-caption">'+e.tableCaption+"</caption>"),"<table>"+v+l+"<tbody>"+s.join("")+"</tbody></table>"},r.prototype.getCellHTMLFromValue=function(t,e,r,o,n){var i=o,s="text"+(e?" "+e:"");return"number"==typeof i?(i=i.toString(),","===n&&(i=i.replace(".",n)),s="number"):o||(i="",s="empty"),"<"+t+(r?" "+r:"")+' class="'+s+'">'+i+"</"+t+">"},r.prototype.getTableHeaderHTML=function(t,e,r){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===r&&(r=this.options);var o,n,i=r.useMultiLevelHeaders,s=r.useRowspanHeaders,a="<thead>",u=0,l=e&&e.length,c=0;if(i&&t&&e&&!function(t,e){var r=t.length;if(e.length!==r)return!1;for(;--r;)if(t[r]!==e[r])return!1;return!0}(t,e)){for(a+="<tr>";u<l;++u)(o=t[u])===t[u+1]?++c:c?(a+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" colspan="'+(c+1)+'"',o),c=0):(o===e[u]?s?(n=2,delete e[u]):(n=1,e[u]=""):n=1,a+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(n>1?' valign="top" rowspan="'+n+'"':""),o));a+="</tr>"}if(e){for(a+="<tr>",u=0,l=e.length;u<l;++u)void 0!==e[u]&&(a+=this.getCellHTMLFromValue("th",null,'scope="col"',e[u]));a+="</tr>"}return a+"</thead>"},r.prototype.parse=function(t,e){var r=[],o=[],n=i(this.options,t),s=n.endRow,a=n.startColumn,u=n.endColumn,l=n.firstRowAsNames,c=n.tableElement||this.tableElement;if(!(c instanceof HTMLElement)){this.emit({type:"parseError",columns:r,detail:e,headers:o,error:"Not a valid HTML Table"});return}this.tableElement=c,this.tableElementID=c.id,this.emit({type:"parse",columns:this.columns,detail:e,headers:this.headers});var f,p=c.getElementsByTagName("tr"),h=p.length,m=0,d=n.startRow;if(l&&h){for(var g=p[0].children,y=g.length,v=a;v<y&&!(v>u);v++)("TD"===(f=g[v]).tagName||"TH"===f.tagName)&&o.push(f.innerHTML);d++}for(;m<h;){if(m>=d&&m<=s)for(var b=p[m].children,C=b.length,w=0;w<C;){var j=w-a,D=r[j];if(("TD"===(f=b[w]).tagName||"TH"===f.tagName)&&w>=a&&w<=u){r[j]||(r[j]=[]);var O=this.asGuessedType(f.innerHTML);O instanceof Date&&(O=O.getTime()),r[j][m-d]=O;for(var v=1;m-d>=v&&void 0===D[m-d-v];)D[m-d-v]=null,v++}w++}m++}this.columns=r,this.headers=o,this.emit({type:"afterParse",columns:r,detail:e,headers:o})},r.prototype.getTable=function(){return t.getTableFromColumns(this.columns,this.headers)},r.defaultOptions=n(n({},t.defaultOptions),{useRowspanHeaders:!0,useMultiLevelHeaders:!0}),r}(t)}),r(e,"Data/Connectors/HTMLTableConnector.js",[e["Data/Connectors/DataConnector.js"],e["Core/Globals.js"],e["Data/Converters/HTMLTableConverter.js"],e["Core/Utilities.js"]],function(t,e,r,o){var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=e.win,a=o.merge,u=function(t){function e(o){var n=this,i=a(e.defaultOptions,o);return(n=t.call(this,i)||this).converter=new r(i),n.options=i,n}return i(e,t),e.prototype.load=function(t){var e,r=this,o=r.converter,n=r.table,i=r.options,u=i.dataModifier,l=i.table;if(r.emit({type:"load",detail:t,table:n,tableElement:r.tableElement}),"string"==typeof l?(r.tableID=l,e=s.document.getElementById(l)):(e=l,r.tableID=e.id),r.tableElement=e||void 0,!r.tableElement){var c="HTML table not provided, or element with ID not found";return r.emit({type:"loadError",detail:t,error:c,table:n}),Promise.reject(Error(c))}return o.parse(a({tableElement:r.tableElement},r.options),t),n.deleteColumns(),n.setColumns(o.getTable().getColumns()),r.setModifierOptions(u).then(function(){return r.emit({type:"afterLoad",detail:t,table:n,tableElement:r.tableElement}),r})},e.defaultOptions={table:""},e}(t);return t.registerType("HTMLTable",u),u}),r(e,"Data/Modifiers/ChainModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(t,e){var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=e.merge,i=function(e){function r(o){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var a=e.call(this)||this;a.chain=i,a.options=n(r.defaultOptions,o);for(var u=a.options.chain||[],l=0,c=u.length,f=void 0,p=void 0;l<c;++l)(f=u[l]).type&&(p=t.types[f.type])&&i.push(new p(f));return a}return o(r,e),r.prototype.add=function(t,e){this.emit({type:"addModifier",detail:e,modifier:t}),this.chain.push(t),this.emit({type:"addModifier",detail:e,modifier:t})},r.prototype.clear=function(t){this.emit({type:"clearChain",detail:t}),this.chain.length=0,this.emit({type:"afterClearChain",detail:t})},r.prototype.modify=function(t,e){var r=this,o=this.options.reverse?this.chain.slice().reverse():this.chain.slice();t.modified===t&&(t.modified=t.clone(!1,e));for(var n=Promise.resolve(t),i=0,s=o.length;i<s;++i)!function(t,r){var i=o[t];n=n.then(function(t){return i.modify(t.modified,e)})}(i,0);return n=(n=n.then(function(e){return t.modified.deleteColumns(),t.modified.setColumns(e.modified.getColumns()),t})).catch(function(o){throw r.emit({type:"error",detail:e,table:t}),o})},r.prototype.modifyCell=function(t,e,r,o,n){var i=this.options.reverse?this.chain.reverse():this.chain;if(i.length){for(var s=t.clone(),a=0,u=i.length;a<u;++a)i[a].modifyCell(s,e,r,o,n),s=s.modified;t.modified=s}return t},r.prototype.modifyColumns=function(t,e,r,o){var n=this.options.reverse?this.chain.reverse():this.chain.slice();if(n.length){for(var i=t.clone(),s=0,a=n.length;s<a;++s)n[s].modifyColumns(i,e,r,o),i=i.modified;t.modified=i}return t},r.prototype.modifyRows=function(t,e,r,o){var n=this.options.reverse?this.chain.reverse():this.chain.slice();if(n.length){for(var i=t.clone(),s=0,a=n.length;s<a;++s)n[s].modifyRows(i,e,r,o),i=i.modified;t.modified=i}return t},r.prototype.modifyTable=function(t,e){this.emit({type:"modify",detail:e,table:t});for(var r=this.options.reverse?this.chain.reverse():this.chain.slice(),o=t.modified,n=0,i=r.length;n<i;++n)o=(0,r[n]).modifyTable(o,e).modified;return t.modified=o,this.emit({type:"afterModify",detail:e,table:t}),t},r.prototype.remove=function(t,e){var r=this.chain;this.emit({type:"removeModifier",detail:e,modifier:t}),r.splice(r.indexOf(t),1),this.emit({type:"afterRemoveModifier",detail:e,modifier:t})},r.defaultOptions={type:"Chain"},r}(t);return t.registerType("Chain",i),i}),r(e,"Data/Modifiers/InvertModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(t,e){var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=e.merge,i=function(t){function e(r){var o=t.call(this)||this;return o.options=n(e.defaultOptions,r),o}return o(e,t),e.prototype.modifyCell=function(t,e,r,o,n){var i=t.modified,s=i.getRowIndexBy("columnNames",e);return void 0===s?i.setColumns(this.modifyTable(t.clone()).getColumns(),void 0,n):i.setCell("".concat(r),s,o,n),t},e.prototype.modifyColumns=function(t,e,r,o){var n=t.modified,i=n.getColumn("columnNames")||[],s=t.getColumnNames(),a=t.getRowCount()!==i.length;if(!a){for(var u=0,l=s.length;u<l;++u)if(s[u]!==i[u]){a=!0;break}}if(a)return this.modifyTable(t,o);s=Object.keys(e);for(var u=0,l=s.length,c=void 0,f=void 0,p=void 0;u<l;++u){c=e[f=s[u]],p=n.getRowIndexBy("columnNames",f)||n.getRowCount();for(var h=0,m=r,d=c.length;h<d;++h,++m)n.setCell("".concat(m),p,c[h],o)}return t},e.prototype.modifyRows=function(t,e,r,o){var n=t.getColumnNames(),i=t.modified,s=i.getColumn("columnNames")||[],a=t.getRowCount()!==s.length;if(!a){for(var u=0,l=n.length;u<l;++u)if(n[u]!==s[u]){a=!0;break}}if(a)return this.modifyTable(t,o);for(var u=0,c=r,l=e.length,f=void 0;u<l;++u,++c)if((f=e[u])instanceof Array)i.setColumn("".concat(c),f);else for(var p=0,h=n.length;p<h;++p)i.setCell("".concat(c),p,f[n[p]],o);return t},e.prototype.modifyTable=function(t,e){this.emit({type:"modify",detail:e,table:t});var r=t.modified;if(t.hasColumns(["columnNames"])){for(var o=((t.deleteColumns(["columnNames"])||{}).columnNames||[]).map(function(t){return"".concat(t)}),n={},i=0,s=t.getRowCount(),a=void 0;i<s;++i)(a=t.getRow(i))&&(n[o[i]]=a);r.deleteColumns(),r.setColumns(n)}else{for(var n={},i=0,s=t.getRowCount(),a=void 0;i<s;++i)(a=t.getRow(i))&&(n["".concat(i)]=a);n.columnNames=t.getColumnNames(),r.deleteColumns(),r.setColumns(n)}return this.emit({type:"afterModify",detail:e,table:t}),t},e.defaultOptions={type:"Invert"},e}(t);return t.registerType("Invert",i),i}),r(e,"Data/Modifiers/MathModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/Formula/FormulaParser.js"],e["Data/Formula/FormulaProcessor.js"]],function(t,e,r){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},s=function(t){function o(e){var r=t.call(this)||this;return r.options=i(i({},o.defaultOptions),e),r}return n(o,t),o.prototype.modifyTable=function(t,r){this.emit({type:"modify",detail:r,table:t});for(var o=this.options.alternativeSeparators,n=this.options.formulaColumns||t.getColumnNames(),i=t.modified,s=0,a=n.length,u=void 0;s<a;++s)u=n[s],n.indexOf(u)>=0&&i.setColumn(u,this.processColumn(t,u));for(var l=this.options.columnFormulas||[],s=0,a=l.length,c=void 0,f=void 0;s<a;++s)c=l[s],f=e.parseFormula(c.formula,o),i.setColumn(c.column,this.processColumnFormula(f,t,c.rowStart,c.rowEnd));return this.emit({type:"afterModify",detail:r,table:t}),t},o.prototype.processColumn=function(t,o,n){void 0===n&&(n=0);for(var i=this.options.alternativeSeparators,s=(t.getColumn(o,!0)||[]).slice(n>0?n:0),a=0,u=s.length,l=[],c=void 0;a<u;++a)if("string"==typeof(c=s[a])&&"="===c[0])try{l=""===c?l:e.parseFormula(c.substring(1),i),s[a]=r.processFormula(l,t)}catch(t){s[a]=NaN}return s},o.prototype.processColumnFormula=function(t,e,o,n){void 0===o&&(o=0),void 0===n&&(n=e.getRowCount()),o=o>=0?o:0,n=n>=0?n:e.getRowCount()+n;for(var i=[],s=e.modified,a=0,u=n-o;a<u;++a)try{i[a]=r.processFormula(t,s)}catch(t){i[a]=NaN}finally{t=r.translateReferences(t,0,1)}return i},o.defaultOptions={type:"Math",alternativeSeparators:!1},o}(t);return t.registerType("Math",s),s}),r(e,"Data/Modifiers/RangeModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Core/Utilities.js"]],function(t,e){var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),n=e.merge,i=function(t){function e(r){var o=t.call(this)||this;return o.options=n(e.defaultOptions,r),o}return o(e,t),e.prototype.modifyTable=function(t,e){this.emit({type:"modify",detail:e,table:t});var r=this.options,o=r.additive,n=r.ranges,i=r.strict;if(n.length){for(var s=t.modified,a=t.getColumns(),u=[],l=0,c=n.length,f=void 0,p=void 0;l<c;++l)if(f=n[l],!i||typeof f.minValue==typeof f.maxValue){l>0&&!o&&(s.deleteRows(),s.setRows(u),a=s.getColumns(),u=[]),p=a[f.column]||[];for(var h=0,m=p.length,d=void 0,g=void 0;h<m;++h){switch(typeof(d=p[h])){default:continue;case"boolean":case"number":case"string":}(!i||typeof d==typeof f.minValue)&&d>=f.minValue&&d<=f.maxValue&&(g=o?t.getRow(h):s.getRow(h))&&u.push(g)}}s.deleteRows(),s.setRows(u)}return this.emit({type:"afterModify",detail:e,table:t}),t},e.defaultOptions={type:"Range",ranges:[]},e}(t);return t.registerType("Range",i),i}),r(e,"Data/Modifiers/SortModifier.js",[e["Data/Modifiers/DataModifier.js"],e["Data/DataTable.js"],e["Core/Utilities.js"]],function(t,e,r){var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=r.merge,s=function(t){function r(e){var o=t.call(this)||this;return o.options=i(r.defaultOptions,e),o}return n(r,t),r.ascending=function(t,e){return(t||0)<(e||0)?-1:(t||0)>(e||0)?1:0},r.descending=function(t,e){return(e||0)<(t||0)?-1:(e||0)>(t||0)?1:0},r.prototype.getRowReferences=function(t){for(var e=t.getRows(),r=[],o=0,n=e.length;o<n;++o)r.push({index:o,row:e[o]});return r},r.prototype.modifyCell=function(t,r,o,n,i){var s=this.options,a=s.orderByColumn,u=s.orderInColumn;return r===a&&(u?(t.modified.setCell(r,o,n),t.modified.setColumn(u,this.modifyTable(new e({columns:t.getColumns([a,u])})).modified.getColumn(u))):this.modifyTable(t,i)),t},r.prototype.modifyColumns=function(t,r,o,n){var i=this.options,s=i.orderByColumn,a=i.orderInColumn,u=Object.keys(r);return u.indexOf(s)>-1&&(a&&r[u[0]].length?(t.modified.setColumns(r,o),t.modified.setColumn(a,this.modifyTable(new e({columns:t.getColumns([s,a])})).modified.getColumn(a))):this.modifyTable(t,n)),t},r.prototype.modifyRows=function(t,r,o,n){var i=this.options,s=i.orderByColumn,a=i.orderInColumn;return a&&r.length?(t.modified.setRows(r,o),t.modified.setColumn(a,this.modifyTable(new e({columns:t.getColumns([s,a])})).modified.getColumn(a))):this.modifyTable(t,n),t},r.prototype.modifyTable=function(t,e){this.emit({type:"modify",detail:e,table:t});var o,n=t.getColumnNames(),i=t.getRowCount(),s=this.getRowReferences(t),a=this.options,u=a.direction,l=a.orderByColumn,c=a.orderInColumn,f="asc"===u?r.ascending:r.descending,p=n.indexOf(l),h=t.modified;if(-1!==p&&s.sort(function(t,e){return f(t.row[p],e.row[p])}),c){for(var m=[],d=0;d<i;++d)m[s[d].index]=d;h.setColumns(((o={})[c]=m,o))}else{for(var g=[],d=0;d<i;++d)g.push(s[d].row);h.setRows(g,0)}return this.emit({type:"afterModify",detail:e,table:t}),t},r.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"},r}(t);return t.registerType("Sort",s),s}),r(e,"masters/modules/data-tools.src.js",[e["Core/Globals.js"],e["Data/Connectors/DataConnector.js"],e["Data/Converters/DataConverter.js"],e["Data/DataCursor.js"],e["Data/Modifiers/DataModifier.js"],e["Data/DataPool.js"],e["Data/DataTable.js"],e["Data/Formula/Formula.js"]],function(t,e,r,o,n,i,s,a){return t.DataConnector=t.DataConnector||e,t.DataConverter=t.DataConverter||r,t.DataCursor=t.DataCursor||o,t.DataModifier=t.DataModifier||n,t.DataPool=t.DataPool||i,t.DataTable=t.DataTable||s,t.Formula=t.Formula||a,t})});